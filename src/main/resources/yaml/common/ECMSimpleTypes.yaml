components:
  parameters:
    CommonContextQueryParameterType:
      name: commonContext
      in: header
      description: 'Common context '
      required: true
      schema:
        $ref: 'common/common.yaml#/components/schemas/CommonContextType' 
  schemas:
         
# Objekt pro seznamu operací v košíku pro autorizaci, kromě autorizační aspekty - typ předmentu a zda je prefferovaný  
    OperationBasketDataForSignType:
      description: Objekt pro vystavení seznamu operací v košíku pro autorizaci, kromě onformaci o operaci obsahuje autorizační aspekty - typ předmentu a zda je prefferovaný 
      type: object
      required:
        - operations
        - authorizationMethods
      properties:
        operations:
          type: array
          items:
            $ref: '#/components/schemas/OperationDataType'
        authorizationMethods:
          type: array
          items:
             $ref: '#/components/schemas/AuthorizationMethodType'          
        
# Objekt pro vystavení operace pro autorizaci, kromě autorizační aspekty - typ předmentu a zda je prefferovaný  
    OperationDataForSignType:
      description: Objekt pro vystavení operace pro autorizaci, kromě informaci o operaci obsahuje autorizační aspekty - typ předmentu a zda je preferovaný 
      type: object
      required:
        - operation
        - authorizationMethods
      properties:
        operation:
          $ref: '#/components/schemas/OperationDataType'
        authorizationMethods:
          type: array
          items:
             $ref: '#/components/schemas/AuthorizationMethodType'         


# Objekt pro autorizační aspekty - typ předmentu a zda je prefferovaný
    AuthorizationMethodType:
      type: object
      required:
        - securityMethod
        - isPrefferedsecurityMethod
      properties:
        securityMethod:
          $ref: '#/components/schemas/SecurityToolType'       
        isPrefferedsecurityMethod: 
          type: boolean       
# Objekt data pro operaci bez autorizačních aspektů
    OperationDataListType:  
      type: object
      properties:
        operations:
          type: array
          items:
             $ref: '#/components/schemas/OperationDataSimpleType'         
# Objekt data pro operaci zobrazená v seznamu          
    OperationDataSimpleType:      
      type: object
      required:
        - operationId
        - operationKind
        - frameContractId
      properties:
        operationId:
          $ref: '#/components/schemas/OperationIdType'
        operationKind:
          $ref: '#/components/schemas/OperationKindType'
        frameContractId:
          $ref: 'commonSimpleTypes.yaml#/components/schemas/FrameContractIdType'
        amount: 
          $ref: '#/components/schemas/OperationAmountType'
        status: 
          $ref: '#/components/schemas/OperationStatusType' 
        valutaDate:
          $ref: '#/components/schemas/ValutaDateType'   
        disponentSignatureNeeded:
          type: boolean
          description: 'True if disponent signature is missing and disponent has a rights to sign'           
# Objekt data pro vytvoření operace
    PostOperationDataType:      
      type: object
      required:
        - operationKind
        - frameContractId
        - operationDetail
        - manualSignature
      properties:
        operationKind:
          $ref: '#/components/schemas/OperationKindType'
        frameContractId:
          $ref: 'commonSimpleTypes.yaml#/components/schemas/FrameContractIdType'
        amount: 
          $ref: '#/components/schemas/OperationAmountType'
        valutaDate:
          $ref: '#/components/schemas/ValutaDateType'    
        manualSignature:
          $ref: '#/components/schemas/ManualSignatureType'
        operationDetail:
          type: object  
           
# Objekt data pro operaci bez autorizačních aspektů
    OperationDataType:      
      type: object
      required:
        - operationId
        - operationKind
        - operationDetail
        - frameContractId
      properties:
        operationId:
          $ref: '#/components/schemas/OperationIdType'
        operationKind:
          $ref: '#/components/schemas/OperationKindType'
        frameContractId:
          $ref: 'commonSimpleTypes.yaml#/components/schemas/FrameContractIdType'
        amount: 
          $ref: '#/components/schemas/OperationAmountType'
        status: 
          $ref: '#/components/schemas/OperationStatusType' 
        valutaDate:
          $ref: '#/components/schemas/ValutaDateType'  
        createdByBankerLogin:
           type: string
        dateTimeCanceled:
          $ref: '#/components/schemas/DateTimeCanceledType'     
        dateTimeCreated:
          $ref: '#/components/schemas/DateTimeCreatedType'             
        dateTimeReady:
          $ref: '#/components/schemas/DateTimeReadyType' 
        dateTimeSigned:
          $ref: '#/components/schemas/DateTimeSignedType'         
        dateTimeVerified:
          $ref: '#/components/schemas/DateTimeVerifiedType' 
        verifiedByBankerLogin:
          type: string                        
        operationDetail:
          type: object  
        paperScanId:
          $ref: '#/components/schemas/OperationPaperScanIdType' 
        operationSignatures:
          type: array
          items:   
            $ref: '#/components/schemas/OperationSignatureType'                  
            
    OperationSignatureType:
      type: object
      properties:  
        createdByBankerLogin: 
          type: string
        challengeProcessID: 
          type: number
#TODO ověřit správně v datovém modelu
        manualSignatureCheck: 
          type: boolean
        processDateTime: 
          type: string
          format: date-time
        SezamSecToolID: 
          type: string
    
    OperationIdType:
      type: integer
      description: 'Id operace'
      format: int32

    OperationKindType:
      type: string
      description: 'Typ aktivní operace (jednorázová platba, nákup  papírů)'
 #TODO Ověřit správný výčet OperationKindType
      enum:
        - SINGLE_ORDER
        - STANDING_ORDER
        - INKASO
        
    SecurityToolType:
      type: string
      description: 'Bezpečnostní metoda autorizace (SMS, mToken. ...)'
 #TODO Ověřit správný výčet SecurityTool securityDeviceTypeId a hlavně ManualSignature a SMS_TEL
      enum:
        - MTOKEN
        - SMS
        - SMS_TEL
        - HWTOKEN
        - MTOKEN_OFFLINE 
        - MANUAL_SIGNATURE

      
    ManualSignatureType:
      type: boolean
      description: 'Přiznak zda se bude operace ověřovat manuálním papírovám podpisem'  
    
    OperationPaperScanSimpleType:
      type: object
      properties:    
        id:
          $ref: '#/components/schemas/OperationPaperScanIdType' 
        status:
          $ref: '#/components/schemas/OperationPaperScanStatusType'  
        paperScanURL:
          $ref: '#/components/schemas/PaperScanURIType'          

      description: 'Informace o scanu papíropvého pokynu bez binárního obsahu'            
      
    OperationPaperScanType:
      type: object
      properties:
        scanInfo:
          $ref: '#/components/schemas/OperationPaperScanSimpleType' 
        data:
          type: string
          format: byte
          description: Base64-encoded contents of image

      description: 'Binární obsah scanu podpisu'   
      
    OperationStatusType:
      type: string
      description: 'Stav operace v ECM (VYtvořená, částečne podepsaná podepsaná, ...)'
 #TODO Ověřit správný výčet OperationStatusType WAIT_FOR_MANUAL_SIGNATURE_CHECK
      enum:
        - CREATED
        - PARTIALY_SIGNED
        - SIGNED
        - WAIT_FOR_MANUAL_SIGNATURE_CHECK
        - IN_CORE_PROCESS
        - PROCESSED
        - CANCELED     
    OperationAmountType:
      type: number
      description: 'Anmount of the operation'
    ValutaDateType:
      type: string
      format: date
      description: 'Valuta of the operation'
    ChallengeIdType:
      type: number
      description: 'Challenge id created in SEZAM'

     
    DateTimeCanceledType:
      type: string
      format: date-time
      description: 'Cancel time of the operation'      
    DateTimeCreatedType:
      type: string
      format: date-time
      description: 'Created time of the operation'            
    DateTimeReadyType:
      type: string
      format: date-time
      description: 'Ready time of the operation'    
    DateTimeSignedType:
      type: string
      format: date-time
      description: 'Signture time of the operation'                    
    DateTimeVerifiedType:
      type: string
      format: date-time
      description: 'Verified time of the operation'          
            
    OperationPaperScanIdType:
      type: integer
      description: 'Id of operation paper scan '   
      format: int32 
      
    OperationPaperScanStatusType:  
      type: string
      description: 'Paper scan status'
      enum:
        - CREATED
        - PROCESSED
        - CANCELED
        
    PaperScanURIType:
      type: string
      description: 'Paper scan URI in DMS system'